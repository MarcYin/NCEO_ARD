<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/underscore@1.13.1/underscore-min.js"></script>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://unpkg.com/flatgeobuf@3.22.0/dist/flatgeobuf-geojson.min.js"></script>
    <script src="https://unpkg.com/json-formatter-js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdn.rawgit.com/hayeswise/Leaflet.PointInPolygon/v1.0.0/wise-leaflet-pip.js"></script>
    <script src="https://lab.digital-democracy.org/leaflet-bing-layer/leaflet-bing-layer.js"></script>
    <script src="https://unpkg.com/leaflet-geosearch@3.7.0/dist/geosearch.umd.js"></script>
    <!-- Include base CSS (optional) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/base.min.css"/>
    <!-- Include Choices CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css"/>
    <!-- Include Choices JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
    <link id="geosearchStyle" rel="stylesheet" href="https://unpkg.com/leaflet-geosearch@3.7.0/dist/geosearch.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <!-- Include the rangePlugin -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/rangePlugin.js"></script>
    <!-- Add Leaflet.draw styles -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.css" />
    <!-- Add Leaflet.draw scripts -->
    <script src="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>
    <script src="https://unpkg.com/proj4"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/geotiff"></script> -->
    <script src="https://unpkg.com/georaster"></script>
    <script src="https://unpkg.com/georaster-layer-for-leaflet"></script>
    <script src="./Leaflet.ImageOverlay.Rotated.js"></script>
    <!-- <script src="https://raw.githubusercontent.com/digidem/leaflet-side-by-side/gh-pages/leaflet-side-by-side.js"></script> -->
    <script src="
    https://cdn.jsdelivr.net/npm/leaflet-circle-to-polygon@1.0.0/leaflet.circle.topolygon-min.min.js
    "></script>

    <script type="module">
      import geotiffGeokeysToProj4 from 'https://cdn.skypack.dev/geotiff-geokeys-to-proj4';
    </script>
    <link rel="stylesheet" href="map.css">
</head>
<body>
  <div id="search">
    <table>
      <tr>
        <td>
          <!-- <span class="emoji">ğŸ“…</span> -->
          <label style="font-weight: bold; font-size: 1.2em;">ğŸ“… Choose dates:</label>
          <input type="text" id="date-range" placeholder="Select date range">
        </td>
      </tr>

      <tr>
        <td class="cloud-cover">
          <!-- <span class="emoji">â˜ï¸</span> -->
          <label style="font-weight: bold; font-size: 1.2em;">â˜ï¸ Set Cloud Cover:</label>
          <input type="range" id="cloud-cover-slider" min="0" max="100" value="10" step="1">
          <span id="cloud-cover-value">10%</span>
        </td>
      </tr>

      <tr>
        <td>
          <button id="search-button" class="custom-button" style="width: 100px; padding: 10px 15px; border: none; border-radius: 5px; background-color: #007BFF; color: white; font-size: 1.2em; transition: background-color 0.3s; margin-right: 5px; margin-bottom: 10px;">ğŸ”</button>
      
          <button id="back-to-search-results" class="custom-button" style="display: none; width: 100px; padding: 10px 15px; border: none; border-radius: 5px; background-color: #6c757d; color: white; font-size: 1.2em; transition: background-color 0.3s; margin-right: 5px; margin-bottom: 10px;">â¬…ï¸</button>
      
          <button id="field-analysis-button" class="btn btn-primary custom-button" style="width: 210px; padding: 10px 15px; border: none; border-radius: 5px; background-color: #28a745; color: white; font-size: 1.2em; transition: background-color 0.3s;">ğŸ”¬ Field Analysis</button>
        </td>
      </tr>
    
      <!-- <tr>
        <td class="field-analysis-cell">

        </td>
      </tr>
     -->

      <tr>
        <td class="expression-input-cell">
          <label for="expression-input" style="font-weight: bold; font-size: 1.2em;">ğŸ“ Enter Expression:</label>
          <input type="text" id="expression-input" placeholder="(B8A-B04)/(B8A+B04)*(cloud<40)" value="(B8A-B04)/(B8A+B04)*(cloud<40)" style="width: 100%; padding: 10px; font-size: 0.8em; border-radius: 5px; border: 1px solid #ccc;">
        </td>
      </tr>
    
      <tr>
        <td class="colormap-selection-cell">
            <label for="colormap-selection" style="font-weight: bold; font-size: 1.2em;">ğŸ¨ Select Color Map:</label>
            <input list="colormaps" id="colormap-selection" value="reds" style="width: 100%; padding: 5px; font-size: 0.8em; border-radius: 5px; border: 1px solid #ccc;">
            <datalist id="colormaps">
                <!-- Options will be generated dynamically -->
            </datalist>
        </td>
    </tr>
    
    </table>    


   </div>

    <div id="search-results-wrapper">
    <div id="search-results">
      <!-- Search results items go here -->
    </div>
  </div>
  <div id="map"></div>
  <div id="analysis-panel" class="hidden" style="margin: 20px;">
    <div id="analysis-panel-header">
      <h1 style="font-family: Arial, sans-serif; font-size: 24px; color: #268dfb;">Geometry Buesket</h1>
      <p style="font-family: Arial, sans-serif; font-size: 16px;">Draw Geometry to check values</p>
    </div>
    <div id="features-previews" style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px;"></div>
    <!-- <div id="plots" style="border: 1px solid #ccc; padding: 0px; margin-bottom: 20px;"></div>
    <div id="timeSeries" style="border: 1px solid #ccc; padding: 0px;"></div> -->
  </div>
  <div id="timeBarContainer" class="time-bar-container">
    <div id="ticksContainer" class="ticks-container"></div>
</div>

  <script type="module" src="main.js"></script>
</body>
</html>

